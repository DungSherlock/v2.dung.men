summaryInclude=200;var fuseOptions={shouldSort:!0,includeMatches:!0,threshold:0,tokenize:!0,location:0,distance:100,maxPatternLength:32,minMatchCharLength:3,includeScore:!0,isCaseSensitive:!1,keys:[{name:"title",weight:.6},{name:"contents",weight:.3},{name:"tags",weight:.05},{name:"categories",weight:.05}]},searchQuery=param("s");searchQuery&&($("#search-query").val(searchQuery),executeSearch(searchQuery));function executeSearch(a){$("#loading-icon").fadeIn(),$.getJSON("/index.json?t="+$("#search-db-version").text(),function(b){var c=new Fuse(b,fuseOptions),d=c.search(a);$("#loading-icon").hide(),0<d.length?populateResults(d):$("#search-results").append("<p>No matches found</p>")})}function populateResults(a){$.each(a,function(a,b){var c=b.item.contents,d="",e=[];fuseOptions.tokenize?e.push(searchQuery):$.each(b.matches,function(a,b){"tags"==b.key||"categories"==b.key?e.push(b.value):"contents"==b.key&&(start=0<b.indices[0][0]-summaryInclude?b.indices[0][0]-summaryInclude:0,end=b.indices[0][1]+summaryInclude<c.length?b.indices[0][1]+summaryInclude:c.length,d+=c.substring(start,end),e.push(b.value.substring(b.indices[0][0],b.indices[0][1]-b.indices[0][0]+1)))}),1>d.length&&(d+=c.substring(0,2*summaryInclude));var f=$("#search-result-template").html(),g=render(f,{key:a,title:b.item.title,link:b.item.permalink,tags:b.item.tags,categories:b.item.categories,snippet:d,score:b.score});$("#search-results").append(g),$.each(e,function(b,c){$("#summary-"+a).mark(c)})})}function param(a){return decodeURIComponent((location.search.split(a+"=")[1]||"").split("&")[0]).replace(/\+/g," ")}function render(a,b){var c,d,e;for(d=/\$\{\s*isset ([a-zA-Z]*) \s*\}(.*)\$\{\s*end\s*}/g,e=a;null!==(c=d.exec(a));)e=b[c[1]]?e.replace(c[0],c[2]):e.replace(c[0],"");a=e;var f,g,h;for(f in b)g="\\$\\{\\s*"+f+"\\s*\\}",h=new RegExp(g,"g"),a=a.replace(h,b[f]);return a}