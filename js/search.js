summaryInclude=200;var fuseOptions={shouldSort:!0,includeMatches:!0,threshold:0,tokenize:!0,location:0,distance:100,maxPatternLength:32,minMatchCharLength:3,includeScore:!0,isCaseSensitive:!1,keys:[{name:"title",weight:.6},{name:"contents",weight:.3},{name:"tags",weight:.05},{name:"categories",weight:.05}]},searchQuery=param("s");function executeSearch(e){$("#loading-icon").fadeIn(),$.getJSON("/index.json?t="+$("#search-db-version").text(),(function(s){var t=new Fuse(s,fuseOptions).search(e);$("#loading-icon").hide(),t.length>0?populateResults(t):$("#search-results").append("<p>No matches found</p>")}))}function populateResults(e){$.each(e,(function(e,s){var t=s.item.contents,n="",a=[];fuseOptions.tokenize?a.push(searchQuery):$.each(s.matches,(function(e,s){"tags"==s.key||"categories"==s.key?a.push(s.value):"contents"==s.key&&(start=s.indices[0][0]-summaryInclude>0?s.indices[0][0]-summaryInclude:0,end=s.indices[0][1]+summaryInclude<t.length?s.indices[0][1]+summaryInclude:t.length,n+=t.substring(start,end),a.push(s.value.substring(s.indices[0][0],s.indices[0][1]-s.indices[0][0]+1)))})),n.length<1&&(n+=t.substring(0,2*summaryInclude));var r=render($("#search-result-template").html(),{key:e,title:s.item.title,link:s.item.permalink,tags:s.item.tags,categories:s.item.categories,snippet:n,score:s.score});$("#search-results").append(r),$.each(a,(function(s,t){$("#summary-"+e).mark(t)}))}))}function param(e){return decodeURIComponent((location.search.split(e+"=")[1]||"").split("&")[0]).replace(/\+/g," ")}function render(e,s){var t,n,a,r,i;for(n=/\$\{\s*isset ([a-zA-Z]*) \s*\}(.*)\$\{\s*end\s*}/g,a=e;null!==(t=n.exec(e));)a=s[t[1]]?a.replace(t[0],t[2]):a.replace(t[0],"");for(r in e=a,s)i=new RegExp("\\$\\{\\s*"+r+"\\s*\\}","g"),e=e.replace(i,s[r]);return e}searchQuery&&($("#search-query").val(searchQuery),executeSearch(searchQuery));
